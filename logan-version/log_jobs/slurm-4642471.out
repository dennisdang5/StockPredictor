==========================================
SLURM_JOB_ID = 4642471
SLURM_JOB_NODELIST = d14-[05-06]
TMPDIR = /tmp/SLURM_4642471
==========================================
=== Environment sanity checks ===
HOST: d14-05.hpc.usc.edu
Python: /home1/lkyamamo/.conda/envs/csci566-project/bin/python
Python 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
torch 2.8.0+cu129 CUDA available? True
CUDA device count: 2
Device 0: Tesla V100-PCIE-32GB
Mon Nov  3 21:33:51 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:3B:00.0 Off |                    0 |
| N/A   24C    P0             24W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  Tesla V100-PCIE-32GB           On  |   00000000:D8:00.0 Off |                    0 |
| N/A   24C    P0             24W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
MASTER_ADDR=d14-05 MASTER_PORT=29342  NNODES=2  NPROC_PER_NODE=2
my code
============================================================
TRAINING PHASE
============================================================
my code
============================================================
TRAINING PHASE
============================================================
my code
============================================================
TRAINING PHASE
============================================================
my code
============================================================
TRAINING PHASE
============================================================
[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank [Gloo] Rank 2 is connected to 33 is connected to  peer ranks. 3Expected number of connected peer ranks is :  peer ranks. 3Expected number of connected peer ranks is : 3

[distributed] is_dist=True, rank=0/4
[device] using cuda:0
[cuda] Tesla V100-PCIE-32GB (count=2)
[dataloader] num_workers=1, persistent_workers=True, pin_memory=True
[data] Cache not found, downloading and processing data (rank 0 only)...
Fetching data for 503 stocks...
  Progress: 1/503 stocks processed...
$FOXA: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$FOX: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$TTD: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 25/503 stocks processed...
$ABNB: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DASH: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 50/503 stocks processed...
  Progress: 75/503 stocks processed...
$BF.B: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30)
$KVUE: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 100/503 stocks processed...
$LW: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
HTTP Error 404: {"quoteSummary":{"result":null,"error":{"code":"Not Found","description":"Quote not found for symbol: WBA"}}}
$WBA: possibly delisted; no timezone found
$EXE: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 125/503 stocks processed...
$BRK.B: possibly delisted; no timezone found
  Progress: 150/503 stocks processed...
$XYZ: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$COIN: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 175/503 stocks processed...
  Progress: 200/503 stocks processed...
  Progress: 225/503 stocks processed...
$GEHC: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 250/503 stocks processed...
$MRNA: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$SOLV: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 275/503 stocks processed...
$CARR: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DAY: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$FTV: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$GEV: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 300/503 stocks processed...
$HWM: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$IR: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$OTIS: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 325/503 stocks processed...
$UBER: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$VLTO: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 350/503 stocks processed...
$CRWD: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DDOG: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DELL: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 375/503 stocks processed...
$HPE: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$PLTR: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 400/503 stocks processed...
$CTVA: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DOW: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 425/503 stocks processed...
  Progress: 450/503 stocks processed...
$INVH: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$VICI: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 475/503 stocks processed...
$CEG: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 500/503 stocks processed...
$VST: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 503/503 stocks processed...

36 Failed downloads:
['FOXA', 'FOX', 'TTD', 'ABNB', 'DASH', 'BF.B', 'KVUE', 'LW', 'WBA', 'EXE', 'BRK.B', 'XYZ', 'COIN', 'GEHC', 'MRNA', 'SOLV', 'CARR', 'DAY', 'FTV', 'GEV', 'HWM', 'IR', 'OTIS', 'UBER', 'VLTO', 'CRWD', 'DDOG', 'DELL', 'HPE', 'PLTR', 'CTVA', 'DOW', 'INVH', 'VICI', 'CEG', 'VST']: YFPricesMissingError
Successfully fetched data for 467 stocks: ['GOOGL', 'GOOG', 'T', 'CHTR', 'CMCSA', 'EA', 'IPG', 'LYV', 'MTCH', 'META', 'NFLX', 'NWSA', 'NWS', 'OMC', 'PSKY', 'TMUS', 'TTWO', 'TKO', 'VZ', 'DIS', 'WBD', 'AMZN', 'APTV', 'AZO', 'BBY', 'BKNG', 'CZR', 'KMX', 'CCL', 'CMG', 'DRI', 'DECK', 'DPZ', 'DHI', 'EBAY', 'EXPE', 'F', 'GRMN', 'GM', 'GPC', 'HAS', 'HLT', 'HD', 'LVS', 'LEN', 'LKQ', 'LOW', 'LULU', 'MAR', 'MCD', 'MGM', 'MHK', 'NKE', 'NCLH', 'NVR', 'ORLY', 'POOL', 'PHM', 'RL', 'ROST', 'RCL', 'SBUX', 'TPR', 'TSLA', 'TJX', 'TSCO', 'ULTA', 'WSM', 'WYNN', 'YUM', 'MO', 'ADM', 'BG', 'CPB', 'CHD', 'CLX', 'KO', 'CL', 'CAG', 'STZ', 'COST', 'DG', 'DLTR', 'EL', 'GIS', 'HSY', 'HRL', 'K', 'KDP', 'KMB', 'KHC', 'KR', 'MKC', 'TAP', 'MDLZ', 'MNST', 'PEP', 'PM', 'PG', 'SJM', 'SYY', 'TGT', 'TSN', 'WMT', 'APA', 'BKR', 'CVX', 'COP', 'CTRA', 'DVN', 'FANG', 'EOG', 'EQT', 'XOM', 'HAL', 'KMI', 'MPC', 'OXY', 'OKE', 'PSX', 'SLB', 'TRGP', 'TPL', 'VLO', 'WMB', 'AFL', 'ALL', 'AXP', 'AIG', 'AMP', 'AON', 'APO', 'ACGL', 'AJG', 'AIZ', 'BAC', 'BLK', 'BX', 'BK', 'BRO', 'COF', 'CBOE', 'SCHW', 'CB', 'CINF', 'C', 'CFG', 'CME', 'CPAY', 'ERIE', 'EG', 'FDS', 'FIS', 'FITB', 'FI', 'BEN', 'GPN', 'GL', 'GS', 'HIG', 'HBAN', 'ICE', 'IVZ', 'JKHY', 'JPM', 'KEY', 'KKR', 'L', 'MTB', 'MKTX', 'MMC', 'MA', 'MET', 'MCO', 'MS', 'MSCI', 'NDAQ', 'NTRS', 'PYPL', 'PNC', 'PFG', 'PGR', 'PRU', 'RJF', 'RF', 'SPGI', 'STT', 'SYF', 'TROW', 'TRV', 'TFC', 'USB', 'V', 'WRB', 'WFC', 'WTW', 'ABT', 'ABBV', 'A', 'ALGN', 'AMGN', 'BAX', 'BDX', 'TECH', 'BIIB', 'BSX', 'BMY', 'CAH', 'COR', 'CNC', 'CRL', 'CI', 'COO', 'CVS', 'DHR', 'DVA', 'DXCM', 'EW', 'ELV', 'GILD', 'HCA', 'HSIC', 'HOLX', 'HUM', 'IDXX', 'INCY', 'PODD', 'ISRG', 'IQV', 'JNJ', 'LH', 'LLY', 'MCK', 'MDT', 'MRK', 'MTD', 'MOH', 'PFE', 'DGX', 'REGN', 'RMD', 'RVTY', 'STE', 'SYK', 'TMO', 'UNH', 'UHS', 'VRTX', 'VTRS', 'WAT', 'WST', 'ZBH', 'ZTS', 'MMM', 'AOS', 'ALLE', 'AME', 'ADP', 'AXON', 'BA', 'BR', 'BLDR', 'CHRW', 'CAT', 'CTAS', 'CPRT', 'CSX', 'CMI', 'DE', 'DAL', 'DOV', 'ETN', 'EMR', 'EFX', 'EXPD', 'FAST', 'FDX', 'GE', 'GNRC', 'GD', 'HON', 'HUBB', 'HII', 'IEX', 'ITW', 'JBHT', 'J', 'JCI', 'LHX', 'LDOS', 'LII', 'LMT', 'MAS', 'NDSN', 'NSC', 'NOC', 'ODFL', 'PCAR', 'PH', 'PAYX', 'PAYC', 'PNR', 'PWR', 'RTX', 'RSG', 'ROK', 'ROL', 'SNA', 'LUV', 'SWK', 'TXT', 'TT', 'TDG', 'UNP', 'UAL', 'UPS', 'URI', 'VRSK', 'GWW', 'WAB', 'WM', 'XYL', 'ACN', 'ADBE', 'AMD', 'AKAM', 'APH', 'ADI', 'AAPL', 'AMAT', 'ANET', 'ADSK', 'AVGO', 'CDNS', 'CDW', 'CSCO', 'CTSH', 'GLW', 'ENPH', 'EPAM', 'FFIV', 'FICO', 'FSLR', 'FTNT', 'IT', 'GEN', 'GDDY', 'HPQ', 'IBM', 'INTC', 'INTU', 'JBL', 'KEYS', 'KLAC', 'LRCX', 'MCHP', 'MU', 'MSFT', 'MPWR', 'MSI', 'NTAP', 'NVDA', 'NXPI', 'ON', 'ORCL', 'PANW', 'PTC', 'QCOM', 'ROP', 'CRM', 'STX', 'NOW', 'SWKS', 'SMCI', 'SNPS', 'TEL', 'TDY', 'TER', 'TXN', 'TRMB', 'TYL', 'VRSN', 'WDC', 'WDAY', 'ZBRA', 'APD', 'ALB', 'AMCR', 'AVY', 'BALL', 'CF', 'DD', 'EMN', 'ECL', 'FCX', 'IFF', 'IP', 'LIN', 'LYB', 'MLM', 'MOS', 'NEM', 'NUE', 'PKG', 'PPG', 'SHW', 'SW', 'STLD', 'VMC', 'ARE', 'AMT', 'AVB', 'BXP', 'CPT', 'CBRE', 'CSGP', 'CCI', 'DLR', 'EQIX', 'EQR', 'ESS', 'EXR', 'FRT', 'DOC', 'HST', 'IRM', 'KIM', 'MAA', 'PLD', 'PSA', 'O', 'REG', 'SBAC', 'SPG', 'UDR', 'VTR', 'WELL', 'WY', 'AES', 'LNT', 'AEE', 'AEP', 'AWK', 'ATO', 'CNP', 'CMS', 'ED', 'D', 'DTE', 'DUK', 'EIX', 'ETR', 'EVRG', 'ES', 'EXC', 'FE', 'NEE', 'NI', 'NRG', 'PCG', 'PNW', 'PPL', 'PEG', 'SRE', 'SO', 'WEC', 'XEL']
[windows] candidates: 2,926,222 | kept: 2,241,109 (76.6%) | removed: 685,113
[windows] removed breakdown — NaN target: 623,081, feature NaN: 54,387, zero-IQR: 7,645
[split] train/val/test sizes = 1,019,582 / 322,915 / 898,612  | total kept = 2,241,109
Saving training dataset (.npz):   0%|          | 0/3 [00:00<?, ?it/s]Saving training dataset (.npz):  33%|███▎      | 1/3 [00:00<00:01,  1.77it/s]Saving training dataset (.npz): 100%|██████████| 3/3 [00:00<00:00,  5.10it/s]
Saving validation dataset (.npz):   0%|          | 0/3 [00:00<?, ?it/s]Saving validation dataset (.npz):  33%|███▎      | 1/3 [00:00<00:00,  6.57it/s]Saving validation dataset (.npz): 100%|██████████| 3/3 [00:00<00:00, 18.97it/s]
Saving test dataset (.npz):   0%|          | 0/3 [00:00<?, ?it/s]Saving test dataset (.npz):  33%|███▎      | 1/3 [00:00<00:00,  2.05it/s]Saving test dataset (.npz): 100%|██████████| 3/3 [00:00<00:00,  5.91it/s]
Saving metrics dataset (.npz):   0%|          | 0/1 [00:00<?, ?it/s]Saving metrics dataset (.npz): 100%|██████████| 1/1 [00:00<00:00, 61.71it/s]
Classification datasets saved separately:
  Training: classification/data_2c89affd41_classification_train.npz
  Validation: classification/data_2c89affd41_classification_val.npz
  Test: classification/data_2c89affd41_classification_test.npz
  Metrics: classification/data_2c89affd41_classification_metrics.npz
[rank0]:[W1103 21:53:49.120432732 ProcessGroupNCCL.cpp:5023] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can specify device_id in init_process_group() to force use of a particular device.
[rank1]:[W1103 21:53:49.120512399 ProcessGroupNCCL.cpp:5023] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can specify device_id in init_process_group() to force use of a particular device.
[rank3]:[W1103 21:53:49.104877822 ProcessGroupNCCL.cpp:5023] [PG ID 0 PG GUID 0 Rank 3]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can specify device_id in init_process_group() to force use of a particular device.
[rank2]:[W1103 21:53:49.104955228 ProcessGroupNCCL.cpp:5023] [PG ID 0 PG GUID 0 Rank 2]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can specify device_id in init_process_group() to force use of a particular device.
d14-05:174083:174083 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0

[2025-11-03 21:53:49] d14-05:174083:174083 [0] bootstrap.cc:115 NCCL WARN Bootstrap : no socket interface found
d14-05:174083:174083 [0] NCCL INFO init.cc:80 -> 5
d14-05:174083:174083 [0] NCCL INFO init.cc:100 -> 5
[rank0]: Traceback (most recent call last):
[rank0]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 71, in <module>
[rank0]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=5000, prediction_type=prediction_type, saved_model=model_path)
[rank0]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 218, in __init__
[rank0]:     dist.barrier()
[rank0]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank0]:     work = group.barrier(opts=opts)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: torch.distributed.DistBackendError: NCCL error in: /pytorch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:3087, invalid usage (run with NCCL_DEBUG=WARN for details), NCCL version 2.27.3
[rank0]: ncclInvalidUsage: This usually reflects invalid usage of NCCL library.
[rank0]: Last error:
[rank0]: Bootstrap : no socket interface found
W1103 21:53:50.376000 174078 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 174084 closing signal SIGTERM
E1103 21:53:50.546000 174078 site-packages/torch/distributed/elastic/multiprocessing/api.py:874] failed (exitcode: 1) local_rank: 0 (pid: 174083) of binary: /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11
Traceback (most recent call last):
  File "/home1/lkyamamo/.conda/envs/csci566-project/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 901, in main
    run(args)
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 892, in run
    elastic_launch(
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 143, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 277, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-11-03_21:53:50
  host      : d14-05.hpc.usc.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 174083)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[rank2]:[W1103 21:53:50.343284188 TCPStore.cpp:138] [c10d] recvValueWithTimeout failed on SocketImpl(fd=55, addr=[d14-06.hpc.usc.edu]:55062, remote=[d14-05.hpc.usc.edu]:40343): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7efe8973ceb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7efee5f164f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6ab4d (0x7efee5f17b4d in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b209 (0x7efee5f18209 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1c6 (0x7efee5f13616 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7efee5f15003 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x114 (0x7efee5f16114 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7efee5ec4720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7efee5ec4720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7efee5ec4720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int) + 0x5c4 (0x7efe8a6db654 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::initNCCLComm(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, c10::Device&, c10d::OpType, int, bool) + 0x1bba (0x7efe8a6de0fa in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #12: <unknown function> + 0xe80c2f (0x7efe8a6e3c2f in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, char const*, c10d::AllreduceOptions const&) + 0xc2 (0x7efe8a6e44a2 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #14: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x4f2 (0x7efe8a6f35b2 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #15: c10d::ProcessGroupWrapper::barrier(c10d::BarrierOptions const&) + 0xd7 (0x7efee5f0c277 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5d06d00 (0x7efee5eb3d00 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0x5d1446a (0x7efee5ec146a in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0x5341405 (0x7efee54ee405 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0x5d23aa4 (0x7efee5ed0aa4 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #20: <unknown function> + 0x5d24a21 (0x7efee5ed1a21 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0xca141b (0x7efef535e41b in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #22: <unknown function> + 0x3838b0 (0x7efef4a408b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #23: <unknown function> + 0x1f9196 (0x5577dbff5196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #24: _PyObject_MakeTpCall + 0x29b (0x5577dbfd26ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #25: _PyEval_EvalFrameDefault + 0x70a (0x5577dbfdfd2a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #26: _PyFunction_Vectorcall + 0x17f (0x5577dc004a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #27: _PyEval_EvalFrameDefault + 0x4a29 (0x5577dbfe4049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #28: _PyFunction_Vectorcall + 0x17f (0x5577dc004a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #29: <unknown function> + 0x20ff3d (0x5577dc00bf3d in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #30: _PyObject_MakeTpCall + 0x2cb (0x5577dbfd26db in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #31: _PyEval_EvalFrameDefault + 0x70a (0x5577dbfdfd2a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #32: <unknown function> + 0x29b0ad (0x5577dc0970ad in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #33: PyEval_EvalCode + 0x9f (0x5577dc0967ef in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #34: <unknown function> + 0x2b872a (0x5577dc0b472a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #35: <unknown function> + 0x2b43b3 (0x5577dc0b03b3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #36: <unknown function> + 0x2c9780 (0x5577dc0c5780 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #37: _PyRun_SimpleFileObject + 0x1bc (0x5577dc0c511c in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #38: _PyRun_AnyFileObject + 0x44 (0x5577dc0c4ef4 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #39: Py_RunMain + 0x383 (0x5577dc0bf643 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #40: Py_BytesMain + 0x37 (0x5577dc086a17 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #41: __libc_start_main + 0xe5 (0x7eff0e23a7e5 in /lib64/libc.so.6)
frame #42: <unknown function> + 0x28a8ca (0x5577dc0868ca in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)

[rank3]:[W1103 21:53:50.343287788 TCPStore.cpp:138] [c10d] recvValueWithTimeout failed on SocketImpl(fd=55, addr=[d14-06.hpc.usc.edu]:55068, remote=[d14-05.hpc.usc.edu]:40343): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f5232beaeb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7f528f3c44f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6ab4d (0x7f528f3c5b4d in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b209 (0x7f528f3c6209 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1c6 (0x7f528f3c1616 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7f528f3c3003 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x114 (0x7f528f3c4114 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7f528f372720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7f528f372720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7f528f372720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int) + 0x5c4 (0x7f5233b89654 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::initNCCLComm(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, c10::Device&, c10d::OpType, int, bool) + 0x1bba (0x7f5233b8c0fa in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #12: <unknown function> + 0xe80c2f (0x7f5233b91c2f in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, char const*, c10d::AllreduceOptions const&) + 0xc2 (0x7f5233b924a2 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #14: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x4f2 (0x7f5233ba15b2 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #15: c10d::ProcessGroupWrapper::barrier(c10d::BarrierOptions const&) + 0xd7 (0x7f528f3ba277 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5d06d00 (0x7f528f361d00 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0x5d1446a (0x7f528f36f46a in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0x5341405 (0x7f528e99c405 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0x5d23aa4 (0x7f528f37eaa4 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #20: <unknown function> + 0x5d24a21 (0x7f528f37fa21 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #21: <unknown function> + 0xca141b (0x7f529e80c41b in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #22: <unknown function> + 0x3838b0 (0x7f529deee8b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #23: <unknown function> + 0x1f9196 (0x562b882bd196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #24: _PyObject_MakeTpCall + 0x29b (0x562b8829a6ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #25: _PyEval_EvalFrameDefault + 0x70a (0x562b882a7d2a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #26: _PyFunction_Vectorcall + 0x17f (0x562b882cca4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #27: _PyEval_EvalFrameDefault + 0x4a29 (0x562b882ac049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #28: _PyFunction_Vectorcall + 0x17f (0x562b882cca4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #29: <unknown function> + 0x20ff3d (0x562b882d3f3d in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #30: _PyObject_MakeTpCall + 0x2cb (0x562b8829a6db in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #31: _PyEval_EvalFrameDefault + 0x70a (0x562b882a7d2a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #32: <unknown function> + 0x29b0ad (0x562b8835f0ad in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #33: PyEval_EvalCode + 0x9f (0x562b8835e7ef in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #34: <unknown function> + 0x2b872a (0x562b8837c72a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #35: <unknown function> + 0x2b43b3 (0x562b883783b3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #36: <unknown function> + 0x2c9780 (0x562b8838d780 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #37: _PyRun_SimpleFileObject + 0x1bc (0x562b8838d11c in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #38: _PyRun_AnyFileObject + 0x44 (0x562b8838cef4 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #39: Py_RunMain + 0x383 (0x562b88387643 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #40: Py_BytesMain + 0x37 (0x562b8834ea17 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #41: __libc_start_main + 0xe5 (0x7f52b76e87e5 in /lib64/libc.so.6)
frame #42: <unknown function> + 0x28a8ca (0x562b8834e8ca in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)

[rank2]: Traceback (most recent call last):
[rank2]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 71, in <module>
[rank2]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=5000, prediction_type=prediction_type, saved_model=model_path)
[rank2]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 218, in __init__
[rank2]:     dist.barrier()
[rank2]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank2]:     return func(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank2]:     work = group.barrier(opts=opts)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]: torch.distributed.DistBackendError: [2] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
[rank2]: Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
[rank2]: frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7efe8973ceb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
[rank2]: frame #1: <unknown function> + 0x5d694f1 (0x7efee5f164f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #2: <unknown function> + 0x5d6ab4d (0x7efee5f17b4d in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #3: <unknown function> + 0x5d6b209 (0x7efee5f18209 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1c6 (0x7efee5f13616 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7efee5f15003 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x114 (0x7efee5f16114 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #7: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7efee5ec4720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #8: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7efee5ec4720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #9: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7efee5ec4720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #10: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int) + 0x5c4 (0x7efe8a6db654 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #11: c10d::ProcessGroupNCCL::initNCCLComm(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, c10::Device&, c10d::OpType, int, bool) + 0x1bba (0x7efe8a6de0fa in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #12: <unknown function> + 0xe80c2f (0x7efe8a6e3c2f in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #13: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, char const*, c10d::AllreduceOptions const&) + 0xc2 (0x7efe8a6e44a2 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #14: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x4f2 (0x7efe8a6f35b2 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #15: c10d::ProcessGroupWrapper::barrier(c10d::BarrierOptions const&) + 0xd7 (0x7efee5f0c277 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #16: <unknown function> + 0x5d06d00 (0x7efee5eb3d00 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #17: <unknown function> + 0x5d1446a (0x7efee5ec146a in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #18: <unknown function> + 0x5341405 (0x7efee54ee405 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #19: <unknown function> + 0x5d23aa4 (0x7efee5ed0aa4 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #20: <unknown function> + 0x5d24a21 (0x7efee5ed1a21 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #21: <unknown function> + 0xca141b (0x7efef535e41b in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
[rank2]: frame #22: <unknown function> + 0x3838b0 (0x7efef4a408b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
[rank2]: frame #23: <unknown function> + 0x1f9196 (0x5577dbff5196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #24: _PyObject_MakeTpCall + 0x29b (0x5577dbfd26ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #25: _PyEval_EvalFrameDefault + 0x70a (0x5577dbfdfd2a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #26: _PyFunction_Vectorcall + 0x17f (0x5577dc004a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #27: _PyEval_EvalFrameDefault + 0x4a29 (0x5577dbfe4049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #28: _PyFunction_Vectorcall + 0x17f (0x5577dc004a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #29: <unknown function> + 0x20ff3d (0x5577dc00bf3d in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #30: _PyObject_MakeTpCall + 0x2cb (0x5577dbfd26db in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #31: _PyEval_EvalFrameDefault + 0x70a (0x5577dbfdfd2a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #32: <unknown function> + 0x29b0ad (0x5577dc0970ad in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #33: PyEval_EvalCode + 0x9f (0x5577dc0967ef in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #34: <unknown function> + 0x2b872a (0x5577dc0b472a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #35: <unknown function> + 0x2b43b3 (0x5577dc0b03b3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #36: <unknown function> + 0x2c9780 (0x5577dc0c5780 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #37: _PyRun_SimpleFileObject + 0x1bc (0x5577dc0c511c in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #38: _PyRun_AnyFileObject + 0x44 (0x5577dc0c4ef4 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #39: Py_RunMain + 0x383 (0x5577dc0bf643 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #40: Py_BytesMain + 0x37 (0x5577dc086a17 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: frame #41: __libc_start_main + 0xe5 (0x7eff0e23a7e5 in /lib64/libc.so.6)
[rank2]: frame #42: <unknown function> + 0x28a8ca (0x5577dc0868ca in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank2]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank3]: Traceback (most recent call last):
[rank3]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 71, in <module>
[rank3]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=5000, prediction_type=prediction_type, saved_model=model_path)
[rank3]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 218, in __init__
[rank3]:     dist.barrier()
[rank3]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank3]:     return func(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank3]:     work = group.barrier(opts=opts)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]: torch.distributed.DistBackendError: [3] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
[rank3]: Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
[rank3]: frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f5232beaeb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
[rank3]: frame #1: <unknown function> + 0x5d694f1 (0x7f528f3c44f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #2: <unknown function> + 0x5d6ab4d (0x7f528f3c5b4d in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #3: <unknown function> + 0x5d6b209 (0x7f528f3c6209 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1c6 (0x7f528f3c1616 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7f528f3c3003 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x114 (0x7f528f3c4114 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #7: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7f528f372720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #8: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7f528f372720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #9: c10d::PrefixStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x30 (0x7f528f372720 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #10: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int) + 0x5c4 (0x7f5233b89654 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #11: c10d::ProcessGroupNCCL::initNCCLComm(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, c10::Device&, c10d::OpType, int, bool) + 0x1bba (0x7f5233b8c0fa in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #12: <unknown function> + 0xe80c2f (0x7f5233b91c2f in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #13: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, char const*, c10d::AllreduceOptions const&) + 0xc2 (0x7f5233b924a2 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #14: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x4f2 (0x7f5233ba15b2 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #15: c10d::ProcessGroupWrapper::barrier(c10d::BarrierOptions const&) + 0xd7 (0x7f528f3ba277 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #16: <unknown function> + 0x5d06d00 (0x7f528f361d00 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #17: <unknown function> + 0x5d1446a (0x7f528f36f46a in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #18: <unknown function> + 0x5341405 (0x7f528e99c405 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #19: <unknown function> + 0x5d23aa4 (0x7f528f37eaa4 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #20: <unknown function> + 0x5d24a21 (0x7f528f37fa21 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #21: <unknown function> + 0xca141b (0x7f529e80c41b in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
[rank3]: frame #22: <unknown function> + 0x3838b0 (0x7f529deee8b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
[rank3]: frame #23: <unknown function> + 0x1f9196 (0x562b882bd196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #24: _PyObject_MakeTpCall + 0x29b (0x562b8829a6ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #25: _PyEval_EvalFrameDefault + 0x70a (0x562b882a7d2a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #26: _PyFunction_Vectorcall + 0x17f (0x562b882cca4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #27: _PyEval_EvalFrameDefault + 0x4a29 (0x562b882ac049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #28: _PyFunction_Vectorcall + 0x17f (0x562b882cca4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #29: <unknown function> + 0x20ff3d (0x562b882d3f3d in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #30: _PyObject_MakeTpCall + 0x2cb (0x562b8829a6db in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #31: _PyEval_EvalFrameDefault + 0x70a (0x562b882a7d2a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #32: <unknown function> + 0x29b0ad (0x562b8835f0ad in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #33: PyEval_EvalCode + 0x9f (0x562b8835e7ef in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #34: <unknown function> + 0x2b872a (0x562b8837c72a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #35: <unknown function> + 0x2b43b3 (0x562b883783b3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #36: <unknown function> + 0x2c9780 (0x562b8838d780 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #37: _PyRun_SimpleFileObject + 0x1bc (0x562b8838d11c in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #38: _PyRun_AnyFileObject + 0x44 (0x562b8838cef4 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #39: Py_RunMain + 0x383 (0x562b88387643 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #40: Py_BytesMain + 0x37 (0x562b8834ea17 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: frame #41: __libc_start_main + 0xe5 (0x7f52b76e87e5 in /lib64/libc.so.6)
[rank3]: frame #42: <unknown function> + 0x28a8ca (0x562b8834e8ca in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
[rank3]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank2]:[W1103 21:53:50.366298129 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=55, addr=[d14-06.hpc.usc.edu]:55062, remote=[d14-05.hpc.usc.edu]:40343): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7efe8973ceb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7efee5f164f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6a8ed (0x7efee5f178ed in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b49a (0x7efee5f1849a in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x7efee5f131be in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7efe8a6d3598 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xd8198 (0x7eff0b049198 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/numpy/_core/../../../../libstdc++.so.6)
frame #7: <unknown function> + 0x81ca (0x7eff0ed681ca in /lib64/libpthread.so.0)
frame #8: clone + 0x43 (0x7eff0e2398d3 in /lib64/libc.so.6)

[rank2]:[W1103 21:53:50.378681750 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0 Rank 2] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
[rank3]:[W1103 21:53:50.366291934 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=55, addr=[d14-06.hpc.usc.edu]:55068, remote=[d14-05.hpc.usc.edu]:40343): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f5232beaeb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7f528f3c44f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6a8ed (0x7f528f3c58ed in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b49a (0x7f528f3c649a in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x31e (0x7f528f3c11be in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::HeartbeatMonitor::runLoop() + 0x398 (0x7f5233b81598 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xd8198 (0x7f52b44f7198 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/numpy/_core/../../../../libstdc++.so.6)
frame #7: <unknown function> + 0x81ca (0x7f52b82161ca in /lib64/libpthread.so.0)
frame #8: clone + 0x43 (0x7f52b76e78d3 in /lib64/libc.so.6)

[rank3]:[W1103 21:53:50.380722834 ProcessGroupNCCL.cpp:1783] [PG ID 0 PG GUID 0 Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
srun: error: d14-05: task 0: Exited with exit code 1
[rank2]:[W1103 21:53:51.749533722 ProcessGroupNCCL.cpp:1538] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W1103 21:53:51.439000 152448 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 152452 closing signal SIGTERM
E1103 21:53:51.506000 152448 site-packages/torch/distributed/elastic/multiprocessing/api.py:874] failed (exitcode: 1) local_rank: 0 (pid: 152451) of binary: /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11
Traceback (most recent call last):
  File "/home1/lkyamamo/.conda/envs/csci566-project/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 901, in main
    run(args)
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 892, in run
    elastic_launch(
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 143, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 277, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-11-03_21:53:51
  host      : d14-06.hpc.usc.edu
  rank      : 2 (local_rank: 0)
  exitcode  : 1 (pid: 152451)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
srun: error: d14-06: task 1: Exited with exit code 1
