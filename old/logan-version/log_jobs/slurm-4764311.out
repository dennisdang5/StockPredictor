==========================================
SLURM_JOB_ID = 4764311
SLURM_JOB_NODELIST = d13-[03-04,10],d14-11
TMPDIR = /tmp/SLURM_4764311
==========================================
=== Environment sanity checks ===
HOST: d13-03.hpc.usc.edu
Python: /home1/lkyamamo/.conda/envs/csci566-project/bin/python
Python 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
torch 2.8.0+cu129 CUDA available? True
CUDA device count: 2
Device 0: Tesla V100-PCIE-32GB
Tue Nov 11 02:55:28 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:3B:00.0 Off |                    0 |
| N/A   26C    P0             24W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  Tesla V100-PCIE-32GB           On  |   00000000:D8:00.0 Off |                    0 |
| N/A   27C    P0             24W /  250W |       0MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
[NCCL] Using ib0 interface (InfiniBand)
MASTER_ADDR=d13-03 MASTER_PORT=25446  NNODES=4  NPROC_PER_NODE=2
my code
============================================================
TRAINING PHASE
============================================================
my code
my code
============================================================
TRAINING PHASE
============================================================
my code
============================================================
TRAINING PHASE
============================================================
============================================================
TRAINING PHASE
============================================================
my code
============================================================
TRAINING PHASE
============================================================
my code
============================================================
TRAINING PHASE
============================================================
my code
============================================================
TRAINING PHASE
============================================================
my code
============================================================
TRAINING PHASE
============================================================
[Gloo] Rank 6 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 7 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank [Gloo] Rank 0 is connected to 17 is connected to  peer ranks. 7Expected number of connected peer ranks is :  peer ranks. 7Expected number of connected peer ranks is : 
7
[Gloo] Rank 2 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 3 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 5 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 4 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[distributed] is_dist=True, rank=0/8
[device] using cuda:0
[cuda] Tesla V100-PCIE-32GB (count=2)
[dataloader] num_workers=1, persistent_workers=True, pin_memory=True
[data] Cache not found, downloading data (rank 0 only)...
Fetching data for 503 stocks...
  Progress: 1/503 stocks processed...
$FOXA: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$FOX: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$TTD: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 25/503 stocks processed...
$ABNB: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DASH: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 50/503 stocks processed...
  Progress: 75/503 stocks processed...
$BF.B: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30)
$KVUE: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 100/503 stocks processed...
$LW: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
HTTP Error 404: {"quoteSummary":{"result":null,"error":{"code":"Not Found","description":"Quote not found for symbol: WBA"}}}
$WBA: possibly delisted; no timezone found
$EXE: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 125/503 stocks processed...
$BRK.B: possibly delisted; no timezone found
  Progress: 150/503 stocks processed...
$XYZ: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$COIN: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 175/503 stocks processed...
  Progress: 200/503 stocks processed...
  Progress: 225/503 stocks processed...
$GEHC: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 250/503 stocks processed...
$MRNA: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$SOLV: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 275/503 stocks processed...
$CARR: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DAY: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$FTV: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$GEV: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 300/503 stocks processed...
$HWM: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$IR: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$OTIS: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 325/503 stocks processed...
$UBER: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$VLTO: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 350/503 stocks processed...
$CRWD: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DDOG: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DELL: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 375/503 stocks processed...
$HPE: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$PLTR: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 400/503 stocks processed...
$CTVA: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$DOW: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 425/503 stocks processed...
  Progress: 450/503 stocks processed...
$INVH: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
$VICI: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 475/503 stocks processed...
$CEG: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 500/503 stocks processed...
$VST: possibly delisted; no price data found  (1d 1989-12-01 -> 2015-09-30) (Yahoo error = "Data doesn't exist for startDate = 628491600, endDate = 1443585600")
  Progress: 503/503 stocks processed...

36 Failed downloads:
['FOXA', 'FOX', 'TTD', 'ABNB', 'DASH', 'BF.B', 'KVUE', 'LW', 'WBA', 'EXE', 'BRK.B', 'XYZ', 'COIN', 'GEHC', 'MRNA', 'SOLV', 'CARR', 'DAY', 'FTV', 'GEV', 'HWM', 'IR', 'OTIS', 'UBER', 'VLTO', 'CRWD', 'DDOG', 'DELL', 'HPE', 'PLTR', 'CTVA', 'DOW', 'INVH', 'VICI', 'CEG', 'VST']: YFPricesMissingError
Successfully fetched data for 467 stocks: ['GOOGL', 'GOOG', 'T', 'CHTR', 'CMCSA', 'EA', 'IPG', 'LYV', 'MTCH', 'META', 'NFLX', 'NWSA', 'NWS', 'OMC', 'PSKY', 'TMUS', 'TTWO', 'TKO', 'VZ', 'DIS', 'WBD', 'AMZN', 'APTV', 'AZO', 'BBY', 'BKNG', 'CZR', 'KMX', 'CCL', 'CMG', 'DRI', 'DECK', 'DPZ', 'DHI', 'EBAY', 'EXPE', 'F', 'GRMN', 'GM', 'GPC', 'HAS', 'HLT', 'HD', 'LVS', 'LEN', 'LKQ', 'LOW', 'LULU', 'MAR', 'MCD', 'MGM', 'MHK', 'NKE', 'NCLH', 'NVR', 'ORLY', 'POOL', 'PHM', 'RL', 'ROST', 'RCL', 'SBUX', 'TPR', 'TSLA', 'TJX', 'TSCO', 'ULTA', 'WSM', 'WYNN', 'YUM', 'MO', 'ADM', 'BG', 'CPB', 'CHD', 'CLX', 'KO', 'CL', 'CAG', 'STZ', 'COST', 'DG', 'DLTR', 'EL', 'GIS', 'HSY', 'HRL', 'K', 'KDP', 'KMB', 'KHC', 'KR', 'MKC', 'TAP', 'MDLZ', 'MNST', 'PEP', 'PM', 'PG', 'SJM', 'SYY', 'TGT', 'TSN', 'WMT', 'APA', 'BKR', 'CVX', 'COP', 'CTRA', 'DVN', 'FANG', 'EOG', 'EQT', 'XOM', 'HAL', 'KMI', 'MPC', 'OXY', 'OKE', 'PSX', 'SLB', 'TRGP', 'TPL', 'VLO', 'WMB', 'AFL', 'ALL', 'AXP', 'AIG', 'AMP', 'AON', 'APO', 'ACGL', 'AJG', 'AIZ', 'BAC', 'BLK', 'BX', 'BK', 'BRO', 'COF', 'CBOE', 'SCHW', 'CB', 'CINF', 'C', 'CFG', 'CME', 'CPAY', 'ERIE', 'EG', 'FDS', 'FIS', 'FITB', 'FI', 'BEN', 'GPN', 'GL', 'GS', 'HIG', 'HBAN', 'ICE', 'IVZ', 'JKHY', 'JPM', 'KEY', 'KKR', 'L', 'MTB', 'MKTX', 'MMC', 'MA', 'MET', 'MCO', 'MS', 'MSCI', 'NDAQ', 'NTRS', 'PYPL', 'PNC', 'PFG', 'PGR', 'PRU', 'RJF', 'RF', 'SPGI', 'STT', 'SYF', 'TROW', 'TRV', 'TFC', 'USB', 'V', 'WRB', 'WFC', 'WTW', 'ABT', 'ABBV', 'A', 'ALGN', 'AMGN', 'BAX', 'BDX', 'TECH', 'BIIB', 'BSX', 'BMY', 'CAH', 'COR', 'CNC', 'CRL', 'CI', 'COO', 'CVS', 'DHR', 'DVA', 'DXCM', 'EW', 'ELV', 'GILD', 'HCA', 'HSIC', 'HOLX', 'HUM', 'IDXX', 'INCY', 'PODD', 'ISRG', 'IQV', 'JNJ', 'LH', 'LLY', 'MCK', 'MDT', 'MRK', 'MTD', 'MOH', 'PFE', 'DGX', 'REGN', 'RMD', 'RVTY', 'STE', 'SYK', 'TMO', 'UNH', 'UHS', 'VRTX', 'VTRS', 'WAT', 'WST', 'ZBH', 'ZTS', 'MMM', 'AOS', 'ALLE', 'AME', 'ADP', 'AXON', 'BA', 'BR', 'BLDR', 'CHRW', 'CAT', 'CTAS', 'CPRT', 'CSX', 'CMI', 'DE', 'DAL', 'DOV', 'ETN', 'EMR', 'EFX', 'EXPD', 'FAST', 'FDX', 'GE', 'GNRC', 'GD', 'HON', 'HUBB', 'HII', 'IEX', 'ITW', 'JBHT', 'J', 'JCI', 'LHX', 'LDOS', 'LII', 'LMT', 'MAS', 'NDSN', 'NSC', 'NOC', 'ODFL', 'PCAR', 'PH', 'PAYX', 'PAYC', 'PNR', 'PWR', 'RTX', 'RSG', 'ROK', 'ROL', 'SNA', 'LUV', 'SWK', 'TXT', 'TT', 'TDG', 'UNP', 'UAL', 'UPS', 'URI', 'VRSK', 'GWW', 'WAB', 'WM', 'XYL', 'ACN', 'ADBE', 'AMD', 'AKAM', 'APH', 'ADI', 'AAPL', 'AMAT', 'ANET', 'ADSK', 'AVGO', 'CDNS', 'CDW', 'CSCO', 'CTSH', 'GLW', 'ENPH', 'EPAM', 'FFIV', 'FICO', 'FSLR', 'FTNT', 'IT', 'GEN', 'GDDY', 'HPQ', 'IBM', 'INTC', 'INTU', 'JBL', 'KEYS', 'KLAC', 'LRCX', 'MCHP', 'MU', 'MSFT', 'MPWR', 'MSI', 'NTAP', 'NVDA', 'NXPI', 'ON', 'ORCL', 'PANW', 'PTC', 'QCOM', 'ROP', 'CRM', 'STX', 'NOW', 'SWKS', 'SMCI', 'SNPS', 'TEL', 'TDY', 'TER', 'TXN', 'TRMB', 'TYL', 'VRSN', 'WDC', 'WDAY', 'ZBRA', 'APD', 'ALB', 'AMCR', 'AVY', 'BALL', 'CF', 'DD', 'EMN', 'ECL', 'FCX', 'IFF', 'IP', 'LIN', 'LYB', 'MLM', 'MOS', 'NEM', 'NUE', 'PKG', 'PPG', 'SHW', 'SW', 'STLD', 'VMC', 'ARE', 'AMT', 'AVB', 'BXP', 'CPT', 'CBRE', 'CSGP', 'CCI', 'DLR', 'EQIX', 'EQR', 'ESS', 'EXR', 'FRT', 'DOC', 'HST', 'IRM', 'KIM', 'MAA', 'PLD', 'PSA', 'O', 'REG', 'SBAC', 'SPG', 'UDR', 'VTR', 'WELL', 'WY', 'AES', 'LNT', 'AEE', 'AEP', 'AWK', 'ATO', 'CNP', 'CMS', 'ED', 'D', 'DTE', 'DUK', 'EIX', 'ETR', 'EVRG', 'ES', 'EXC', 'FE', 'NEE', 'NI', 'NRG', 'PCG', 'PNW', 'PPL', 'PEG', 'SRE', 'SO', 'WEC', 'XEL']
[data] Processing downloaded data and saving to cache...
[features] Computing features for 467 stocks over 6508 time periods...
[features] Step 1/2: Precomputing elementary series...
[features] Step 1/2 complete. Step 2/2: Building feature windows (this may take several minutes)...
[features] Progress: 5.0% (146,638/2,926,222 windows processed)
[features] Progress: 10.0% (293,276/2,926,222 windows processed)
[features] Progress: 15.0% (439,914/2,926,222 windows processed)
[features] Progress: 20.0% (586,552/2,926,222 windows processed)
[features] Progress: 25.1% (733,190/2,926,222 windows processed)
[features] Progress: 30.1% (879,828/2,926,222 windows processed)
[features] Progress: 35.1% (1,026,466/2,926,222 windows processed)
[features] Progress: 40.1% (1,173,104/2,926,222 windows processed)
[features] Progress: 45.1% (1,319,742/2,926,222 windows processed)
[features] Progress: 50.1% (1,466,380/2,926,222 windows processed)
[features] Progress: 55.1% (1,613,018/2,926,222 windows processed)
[features] Progress: 60.1% (1,759,656/2,926,222 windows processed)
[features] Progress: 65.1% (1,906,294/2,926,222 windows processed)
[features] Progress: 70.2% (2,052,932/2,926,222 windows processed)
[features] Progress: 75.2% (2,199,570/2,926,222 windows processed)
[features] Progress: 80.2% (2,346,208/2,926,222 windows processed)
[features] Progress: 85.2% (2,492,846/2,926,222 windows processed)
[features] Progress: 90.2% (2,639,484/2,926,222 windows processed)
[features] Progress: 95.2% (2,786,122/2,926,222 windows processed)
[windows] candidates: 2,926,222 | kept: 2,241,166 (76.6%) | removed: 685,056
[windows] removed breakdown â€” NaN target: 623,081, feature NaN: 54,387, zero-IQR: 7,588, return NaN: 623,081
[util] Fetching S&P 500 data for metrics...
[rank1]:[E1111 03:25:52.819735629 ProcessGroupGloo.cpp:71] Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank5]:[E1111 03:25:52.838589689 ProcessGroupGloo.cpp:71] Rank 5 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank4]:[E1111 03:25:52.838647154 ProcessGroupGloo.cpp:71] Rank 4 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank6]:[E1111 03:25:52.849183261 ProcessGroupGloo.cpp:71] Rank 6 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank7]:[E1111 03:25:52.849218899 ProcessGroupGloo.cpp:71] Rank 7 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank3]:[E1111 03:25:52.852587118 ProcessGroupGloo.cpp:71] Rank 3 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank2]:[E1111 03:25:52.852630578 ProcessGroupGloo.cpp:71] Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank7]: Traceback (most recent call last):
[rank7]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 74, in <module>
[rank7]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=total_epochs, prediction_type=prediction_type, saved_model=model_path)
[rank7]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 257, in __init__
[rank7]:     dist.barrier()
[rank7]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank7]:     return func(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank1]: Traceback (most recent call last):
[rank1]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 74, in <module>
[rank1]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=total_epochs, prediction_type=prediction_type, saved_model=model_path)
[rank1]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 257, in __init__
[rank1]:     dist.barrier()
[rank1]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank1]:     return func(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank7]:     work = group.barrier(opts=opts)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]: RuntimeError: Rank 7 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank7]:  Original exception: 
[rank7]: [/pytorch/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:129] Timed out waiting 1800000ms for send operation to complete
[rank1]:     work = group.barrier(opts=opts)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]: RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank1]:  Original exception: 
[rank1]: [/pytorch/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:129] Timed out waiting 1800000ms for send operation to complete
[rank6]: Traceback (most recent call last):
[rank6]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 74, in <module>
[rank6]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=total_epochs, prediction_type=prediction_type, saved_model=model_path)
[rank6]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 257, in __init__
[rank6]:     dist.barrier()
[rank6]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank6]:     return func(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank5]: Traceback (most recent call last):
[rank5]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 74, in <module>
[rank5]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=total_epochs, prediction_type=prediction_type, saved_model=model_path)
[rank5]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 257, in __init__
[rank5]:     dist.barrier()
[rank5]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank5]:     return func(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank6]:     work = group.barrier(opts=opts)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]: RuntimeError: Rank 6 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank6]:  Original exception: 
[rank6]: [/pytorch/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:129] Timed out waiting 1800000ms for send operation to complete
[rank3]: Traceback (most recent call last):
[rank3]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 74, in <module>
[rank3]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=total_epochs, prediction_type=prediction_type, saved_model=model_path)
[rank3]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 257, in __init__
[rank3]:     dist.barrier()
[rank3]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank3]:     return func(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank5]:     work = group.barrier(opts=opts)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]: RuntimeError: Rank 5 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank5]:  Original exception: 
[rank5]: [/pytorch/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:129] Timed out waiting 1800000ms for send operation to complete
[rank3]:     work = group.barrier(opts=opts)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]: RuntimeError: Rank 3 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank3]:  Original exception: 
[rank3]: [/pytorch/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:129] Timed out waiting 1800000ms for send operation to complete
[rank4]: Traceback (most recent call last):
[rank4]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 74, in <module>
[rank4]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=total_epochs, prediction_type=prediction_type, saved_model=model_path)
[rank4]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 257, in __init__
[rank4]:     dist.barrier()
[rank4]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank4]:     return func(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank2]: Traceback (most recent call last):
[rank2]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/main.py", line 74, in <module>
[rank2]:     train_obj = trainer.Trainer(stocks=stocks, time_args=[start,end], num_epochs=total_epochs, prediction_type=prediction_type, saved_model=model_path)
[rank2]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/scratch1/lkyamamo/stock_prediction/StockPredictor/logan-version/trainer.py", line 257, in __init__
[rank2]:     dist.barrier()
[rank2]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
[rank2]:     return func(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/distributed_c10d.py", line 4811, in barrier
[rank4]:     work = group.barrier(opts=opts)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]: RuntimeError: Rank 4 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank4]:  Original exception: 
[rank4]: [/pytorch/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:129] Timed out waiting 1800000ms for send operation to complete
[rank2]:     work = group.barrier(opts=opts)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]: RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
[rank2]:  Original exception: 
[rank2]: [/pytorch/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:129] Timed out waiting 1800000ms for send operation to complete
[rank4]:[W1111 03:25:52.579484053 ProcessGroupNCCL.cpp:1538] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[rank6]:[W1111 03:25:52.601036699 ProcessGroupNCCL.cpp:1538] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[rank2]:[W1111 03:25:52.652419229 ProcessGroupNCCL.cpp:1538] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W1111 03:25:53.471000 594563 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 594568 closing signal SIGTERM
W1111 03:25:53.602000 402864 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 402869 closing signal SIGTERM
E1111 03:25:53.671000 402864 site-packages/torch/distributed/elastic/multiprocessing/api.py:874] failed (exitcode: 1) local_rank: 0 (pid: 402868) of binary: /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11
Traceback (most recent call last):
  File "/home1/lkyamamo/.conda/envs/csci566-project/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 901, in main
    run(args)
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 892, in run
    elastic_launch(
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 143, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 277, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-11-11_03:25:53
  host      : d14-11.hpc.usc.edu
  rank      : 6 (local_rank: 0)
  exitcode  : 1 (pid: 402868)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
E1111 03:25:53.839000 594563 site-packages/torch/distributed/elastic/multiprocessing/api.py:874] failed (exitcode: 1) local_rank: 1 (pid: 594569) of binary: /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11
Traceback (most recent call last):
  File "/home1/lkyamamo/.conda/envs/csci566-project/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 901, in main
    run(args)
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 892, in run
    elastic_launch(
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 143, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 277, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-11-11_03:25:53
  host      : d13-03.hpc.usc.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 594569)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
srun: error: d14-11: task 3: Exited with exit code 1
srun: error: d13-03: task 0: Exited with exit code 1
[W1111 03:25:54.553892107 TCPStore.cpp:115] [c10d] recvVector failed on SocketImpl(fd=3, addr=[d13-10.hpc.usc.edu]:53442, remote=[d13-03.hpc.usc.edu]:25446): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f04462bfeb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7f04a2a994f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d69a8d (0x7f04a2a99a8d in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6a15b (0x7f04a2a9a15b in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5d6b097 (0x7f04a2a9b097 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::compareSet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::vector<unsigned char, std::allocator<unsigned char> > const&, std::vector<unsigned char, std::allocator<unsigned char> > const&) + 0x261 (0x7f04a2a95bf1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0xc476f6 (0x7f04b1e876f6 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x3838b0 (0x7f04b15c38b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x1f9196 (0x563057e99196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #9: _PyObject_MakeTpCall + 0x29b (0x563057e766ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #10: <unknown function> + 0x227408 (0x563057ec7408 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #11: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #12: _PyFunction_Vectorcall + 0x17f (0x563057ea8a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #13: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #14: _PyFunction_Vectorcall + 0x17f (0x563057ea8a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #15: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #16: <unknown function> + 0x227a92 (0x563057ec7a92 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #17: <unknown function> + 0x227360 (0x563057ec7360 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #18: <unknown function> + 0x2f873f (0x563057f9873f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #19: <unknown function> + 0x2c5d64 (0x563057f65d64 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #20: <unknown function> + 0x81ca (0x7f04c02f71ca in /lib64/libpthread.so.0)
frame #21: clone + 0x43 (0x7f04bf7c88d3 in /lib64/libc.so.6)

W1111 03:25:54.904000 982118 site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1341] The node 'd13-10.hpc.usc.edu_982118_0' has failed to send a keep-alive heartbeat to the rendezvous 'none' due to an error of type RendezvousConnectionError.
[W1111 03:25:54.595581235 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[d13-10.hpc.usc.edu]:53442, remote=[d13-03.hpc.usc.edu]:25446): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f04462bfeb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7f04a2a994f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d69d82 (0x7f04a2a99d82 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b88e (0x7f04a2a9b88e in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5d6b9cd (0x7f04a2a9b9cd in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::compareSet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::vector<unsigned char, std::allocator<unsigned char> > const&, std::vector<unsigned char, std::allocator<unsigned char> > const&) + 0x33a (0x7f04a2a95cca in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0xc476f6 (0x7f04b1e876f6 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x3838b0 (0x7f04b15c38b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x1f9196 (0x563057e99196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #9: _PyObject_MakeTpCall + 0x29b (0x563057e766ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #10: <unknown function> + 0x227408 (0x563057ec7408 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #11: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #12: _PyFunction_Vectorcall + 0x17f (0x563057ea8a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #13: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #14: _PyFunction_Vectorcall + 0x17f (0x563057ea8a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #15: _PyObject_FastCallDictTstate + 0x63 (0x563057e7b2a3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #16: _PyObject_Call_Prepend + 0x69 (0x563057eb04c9 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #17: <unknown function> + 0x2df799 (0x563057f7f799 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #18: PyObject_Call + 0xbe (0x563057eb28ee in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #19: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #20: _PyFunction_Vectorcall + 0x17f (0x563057ea8a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #21: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #22: <unknown function> + 0x29b0ad (0x563057f3b0ad in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #23: PyEval_EvalCode + 0x9f (0x563057f3a7ef in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #24: <unknown function> + 0x2b872a (0x563057f5872a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #25: <unknown function> + 0x2b43b3 (0x563057f543b3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #26: <unknown function> + 0x2c9780 (0x563057f69780 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #27: _PyRun_SimpleFileObject + 0x1bc (0x563057f6911c in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #28: _PyRun_AnyFileObject + 0x44 (0x563057f68ef4 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #29: Py_RunMain + 0x383 (0x563057f63643 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #30: Py_BytesMain + 0x37 (0x563057f2aa17 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #31: __libc_start_main + 0xe5 (0x7f04bf7c97e5 in /lib64/libc.so.6)
frame #32: <unknown function> + 0x28a8ca (0x563057f2a8ca in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)

W1111 03:25:54.958000 982118 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 982125 closing signal SIGTERM
W1111 03:25:54.959000 982118 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 982126 closing signal SIGTERM
[W1111 03:25:54.624257335 TCPStore.cpp:138] [c10d] recvValueWithTimeout failed on SocketImpl(fd=3, addr=[d13-04.hpc.usc.edu]:38196, remote=[d13-03.hpc.usc.edu]:25446): Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:682 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f8011f46eb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7f806e7204f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d6ab4d (0x7f806e721b4d in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b209 (0x7f806e722209 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1c6 (0x7f806e71d616 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7f806e71f003 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x114 (0x7f806e720114 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc472e6 (0x7f807db0e2e6 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3838b0 (0x7f807d24a8b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #9: <unknown function> + 0x1f9196 (0x56552f945196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #10: _PyObject_MakeTpCall + 0x29b (0x56552f9226ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #11: <unknown function> + 0x227408 (0x56552f973408 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #12: _PyEval_EvalFrameDefault + 0x4a29 (0x56552f934049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #13: _PyFunction_Vectorcall + 0x17f (0x56552f954a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #14: _PyEval_EvalFrameDefault + 0x4a29 (0x56552f934049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #15: _PyFunction_Vectorcall + 0x17f (0x56552f954a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #16: _PyObject_FastCallDictTstate + 0x63 (0x56552f9272a3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #17: _PyObject_Call_Prepend + 0x69 (0x56552f95c4c9 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #18: <unknown function> + 0x2df799 (0x56552fa2b799 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #19: PyObject_Call + 0xbe (0x56552f95e8ee in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #20: _PyEval_EvalFrameDefault + 0x4a29 (0x56552f934049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #21: _PyFunction_Vectorcall + 0x17f (0x56552f954a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #22: _PyEval_EvalFrameDefault + 0x4a29 (0x56552f934049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #23: <unknown function> + 0x29b0ad (0x56552f9e70ad in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #24: PyEval_EvalCode + 0x9f (0x56552f9e67ef in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #25: <unknown function> + 0x2b872a (0x56552fa0472a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #26: <unknown function> + 0x2b43b3 (0x56552fa003b3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #27: <unknown function> + 0x2c9780 (0x56552fa15780 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #28: _PyRun_SimpleFileObject + 0x1bc (0x56552fa1511c in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #29: _PyRun_AnyFileObject + 0x44 (0x56552fa14ef4 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #30: Py_RunMain + 0x383 (0x56552fa0f643 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #31: Py_BytesMain + 0x37 (0x56552f9d6a17 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #32: __libc_start_main + 0xe5 (0x7f808b4507e5 in /lib64/libc.so.6)
frame #33: <unknown function> + 0x28a8ca (0x56552f9d68ca in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)

W1111 03:25:54.971000 862924 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 862956 closing signal SIGTERM
W1111 03:25:54.973000 862924 site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 862957 closing signal SIGTERM
[W1111 03:25:55.862422626 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[d13-10.hpc.usc.edu]:53442, remote=[d13-03.hpc.usc.edu]:25446): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f04462bfeb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7f04a2a994f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d69d82 (0x7f04a2a99d82 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b88e (0x7f04a2a9b88e in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x5d6b9cd (0x7f04a2a9b9cd in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::compareSet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::vector<unsigned char, std::allocator<unsigned char> > const&, std::vector<unsigned char, std::allocator<unsigned char> > const&) + 0x33a (0x7f04a2a95cca in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0xc476f6 (0x7f04b1e876f6 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x3838b0 (0x7f04b15c38b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x1f9196 (0x563057e99196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #9: _PyObject_MakeTpCall + 0x29b (0x563057e766ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #10: <unknown function> + 0x227408 (0x563057ec7408 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #11: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #12: _PyFunction_Vectorcall + 0x17f (0x563057ea8a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #13: _PyObject_FastCallDictTstate + 0x63 (0x563057e7b2a3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #14: _PyObject_Call_Prepend + 0x69 (0x563057eb04c9 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #15: <unknown function> + 0x2df799 (0x563057f7f799 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #16: PyObject_Call + 0xbe (0x563057eb28ee in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #17: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #18: _PyFunction_Vectorcall + 0x17f (0x563057ea8a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #19: _PyEval_EvalFrameDefault + 0x4a29 (0x563057e88049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #20: <unknown function> + 0x29b0ad (0x563057f3b0ad in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #21: PyEval_EvalCode + 0x9f (0x563057f3a7ef in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #22: <unknown function> + 0x2b872a (0x563057f5872a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #23: <unknown function> + 0x2b43b3 (0x563057f543b3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #24: <unknown function> + 0x2c9780 (0x563057f69780 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #25: _PyRun_SimpleFileObject + 0x1bc (0x563057f6911c in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #26: _PyRun_AnyFileObject + 0x44 (0x563057f68ef4 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #27: Py_RunMain + 0x383 (0x563057f63643 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #28: Py_BytesMain + 0x37 (0x563057f2aa17 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #29: __libc_start_main + 0xe5 (0x7f04bf7c97e5 in /lib64/libc.so.6)
frame #30: <unknown function> + 0x28a8ca (0x563057f2a8ca in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)

W1111 03:25:55.208000 982118 site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'd13-10.hpc.usc.edu_982118_0' has failed to shutdown the rendezvous 'none' due to an error of type RendezvousConnectionError.
Traceback (most recent call last):
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 117, in _call_store
    return getattr(self._store, store_op)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.distributed.DistNetworkError: Broken pipe

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home1/lkyamamo/.conda/envs/csci566-project/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 901, in main
    run(args)
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 892, in run
    elastic_launch(
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 143, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    result = agent.run()
             ^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    result = f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py", line 715, in run
    result = self._invoke_run(role)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py", line 915, in _invoke_run
    num_nodes_waiting = rdzv_handler.num_nodes_waiting()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 1263, in num_nodes_waiting
    self._state_holder.sync()
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 423, in sync
    set_response = self._backend.set_state(state_bits, self._token)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 100, in set_state
    base64_state: bytes = self._call_store(
                          ^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 119, in _call_store
[W1111 03:25:55.888445768 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[d13-04.hpc.usc.edu]:38196, remote=[d13-03.hpc.usc.edu]:25446): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x80 (0x7f8011f46eb0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5d694f1 (0x7f806e7204f1 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5d69d82 (0x7f806e720d82 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5d6b88e (0x7f806e72288e in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
    raise RendezvousConnectionError(
torch.distributed.elastic.rendezvous.api.RendezvousConnectionError: The connection to the C10d store has failed. See inner exception for details.
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x19e (0x7f806e71d5ee in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7f806e71f003 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x114 (0x7f806e720114 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc472e6 (0x7f807db0e2e6 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3838b0 (0x7f807d24a8b0 in /home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/lib/libtorch_python.so)
frame #9: <unknown function> + 0x1f9196 (0x56552f945196 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #10: _PyObject_MakeTpCall + 0x29b (0x56552f9226ab in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #11: <unknown function> + 0x227408 (0x56552f973408 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #12: _PyEval_EvalFrameDefault + 0x4a29 (0x56552f934049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #13: _PyFunction_Vectorcall + 0x17f (0x56552f954a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #14: _PyObject_FastCallDictTstate + 0x63 (0x56552f9272a3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #15: _PyObject_Call_Prepend + 0x69 (0x56552f95c4c9 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #16: <unknown function> + 0x2df799 (0x56552fa2b799 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #17: PyObject_Call + 0xbe (0x56552f95e8ee in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #18: _PyEval_EvalFrameDefault + 0x4a29 (0x56552f934049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #19: _PyFunction_Vectorcall + 0x17f (0x56552f954a4f in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #20: _PyEval_EvalFrameDefault + 0x4a29 (0x56552f934049 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #21: <unknown function> + 0x29b0ad (0x56552f9e70ad in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #22: PyEval_EvalCode + 0x9f (0x56552f9e67ef in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #23: <unknown function> + 0x2b872a (0x56552fa0472a in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #24: <unknown function> + 0x2b43b3 (0x56552fa003b3 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #25: <unknown function> + 0x2c9780 (0x56552fa15780 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #26: _PyRun_SimpleFileObject + 0x1bc (0x56552fa1511c in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #27: _PyRun_AnyFileObject + 0x44 (0x56552fa14ef4 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #28: Py_RunMain + 0x383 (0x56552fa0f643 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #29: Py_BytesMain + 0x37 (0x56552f9d6a17 in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)
frame #30: __libc_start_main + 0xe5 (0x7f808b4507e5 in /lib64/libc.so.6)
frame #31: <unknown function> + 0x28a8ca (0x56552f9d68ca in /home1/lkyamamo/.conda/envs/csci566-project/bin/python3.11)

W1111 03:25:55.221000 862924 site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'd13-04.hpc.usc.edu_862924_0' has failed to shutdown the rendezvous 'none' due to an error of type RendezvousConnectionError.
Traceback (most recent call last):
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 117, in _call_store
    return getattr(self._store, store_op)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.distributed.DistNetworkError: Failed to recv, got 0 bytes. Connection was likely closed. Did the remote server shutdown or crash?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home1/lkyamamo/.conda/envs/csci566-project/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 901, in main
    run(args)
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/run.py", line 892, in run
    elastic_launch(
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 143, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    result = agent.run()
             ^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    result = f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py", line 715, in run
    result = self._invoke_run(role)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py", line 915, in _invoke_run
    num_nodes_waiting = rdzv_handler.num_nodes_waiting()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 1263, in num_nodes_waiting
    self._state_holder.sync()
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 437, in sync
    get_response = self._backend.get_state()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 75, in get_state
    base64_state: bytes = self._call_store("get", self._key)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/lkyamamo/.conda/envs/csci566-project/lib/python3.11/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 119, in _call_store
    raise RendezvousConnectionError(
torch.distributed.elastic.rendezvous.api.RendezvousConnectionError: The connection to the C10d store has failed. See inner exception for details.
srun: error: d13-04: task 1: Exited with exit code 1
srun: error: d13-10: task 2: Exited with exit code 1
